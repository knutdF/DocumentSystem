name: Update File Names with Version

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  update-file-names:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v2

    - name: Update File Names
      run: |
        #!/bin/bash

        # Überprüfen, ob die VERSION-Datei existiert
        if [ ! -f VERSION ]; then
            echo "VERSION file not found"
            exit 1
        fi
        version=$(cat VERSION)

        # Durchlaufen aller Dateien und Umbenennen
        find . -type f -not -path '*/\.*' | while read file; do
          # Logik zum Aktualisieren des Dateinamens
          # Beispiel: Anhängen der Version an den Dateinamen
          mv "$file" "${file%.*}-$version.${file##*.}"
        done

    - name: Commit and Push Changes
      run: |
        git config --global user.name 'Your Name'
        git config --global user.email 'your-email@example.com'
        git add .
        git commit -m "Update file names with version $version"
        git push
